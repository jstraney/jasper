function X2JS(e){"use strict";function t(){void 0===e.escapeMode&&(e.escapeMode=!0),e.attributePrefix=e.attributePrefix||"_",e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[]}function n(){function e(e){var t=String(e);return 1===t.length&&(t="0"+t),t}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}function o(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function r(e){return e.prefix}function i(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function a(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function u(t,n,o){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}if(!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0){for(var r=0;r<e.arrayAccessFormPaths.length;r++){var i=e.arrayAccessFormPaths[r];if("string"==typeof i){if(i==o)break}else if(i instanceof RegExp){if(i.test(o))break}else if("function"==typeof i&&i(t,n,o))break}r!=e.arrayAccessFormPaths.length&&(t[n]=[t[n]])}}function c(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),o=t[5].split(".");if(n.setHours(t[3],t[4],o[0]),o.length>1&&n.setMilliseconds(o[1]),t[6]&&t[7]){var r=60*t[6]+Number(t[7]),i=/\d\d-\d\d:\d\d$/.test(e)?"-":"+";r=0+("-"==i?-1*r:r),n.setMinutes(n.getMinutes()-r-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function s(t,n,o){if(e.datetimeAccessFormPaths.length>0){for(var r=o.split(".#")[0],i=0;i<e.datetimeAccessFormPaths.length;i++){var a=e.datetimeAccessFormPaths[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(obj,n,r))break}return i!=e.datetimeAccessFormPaths.length?c(t):t}return t}function l(t,n){if(t.nodeType==x.DOCUMENT_NODE){for(var i=new Object,c=t.childNodes,f=0;f<c.length;f++){var d=c.item(f);if(d.nodeType==x.ELEMENT_NODE){var p=o(d);i[p]=l(d,p)}}return i}if(t.nodeType==x.ELEMENT_NODE){var i=new Object;i.__cnt=0;for(var c=t.childNodes,f=0;f<c.length;f++){var d=c.item(f),p=o(d);d.nodeType!=x.COMMENT_NODE&&(i.__cnt++,null==i[p]?(i[p]=l(d,n+"."+p),u(i,p,n+"."+p)):(null!=i[p]&&(i[p]instanceof Array||(i[p]=[i[p]],u(i,p,n+"."+p))),i[p][i[p].length]=l(d,n+"."+p)))}for(var _=0;_<t.attributes.length;_++){var h=t.attributes.item(_);i.__cnt++,i[e.attributePrefix+h.name]=h.value}var v=r(t);return null!=v&&""!=v&&(i.__cnt++,i.__prefix=v),null!=i["#text"]&&(i.__text=i["#text"],i.__text instanceof Array&&(i.__text=i.__text.join("\n")),e.escapeMode&&(i.__text=a(i.__text)),e.stripWhitespaces&&(i.__text=i.__text.trim()),delete i["#text"],"property"==e.arrayAccessForm&&delete i["#text_asArray"],i.__text=s(i.__text,p,n+"."+p)),null!=i["#cdata-section"]&&(i.__cdata=i["#cdata-section"],delete i["#cdata-section"],"property"==e.arrayAccessForm&&delete i["#cdata-section_asArray"]),1==i.__cnt&&null!=i.__text?i=i.__text:0==i.__cnt&&"text"==e.emptyNodeForm?i="":i.__cnt>1&&null!=i.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==i.__text||""==i.__text.trim())&&delete i.__text,delete i.__cnt,!e.enableToStringFunc||null==i.__text&&null==i.__cdata||(i.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),i}return t.nodeType==x.TEXT_NODE||t.nodeType==x.CDATA_SECTION_NODE?t.nodeValue:void 0}function f(t,n,o,r){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=o)for(var u=0;u<o.length;u++){var c=o[u],s=t[c];e.escapeMode&&(s=i(s)),a+=" "+c.substr(e.attributePrefix.length)+"='"+s+"'"}return a+=r?"/>":">"}function d(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function p(e,t){return-1!==e.indexOf(t,e.length-t.length)}function _(t,n){return!!("property"==e.arrayAccessForm&&p(n.toString(),"_asArray")||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function)}function h(e){var t=0;if(e instanceof Object)for(var n in e)_(e,n)||t++;return t}function v(t){var n=[];if(t instanceof Object)for(var o in t)-1==o.toString().indexOf("__")&&0==o.toString().indexOf(e.attributePrefix)&&n.push(o);return n}function m(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(n+=e.escapeMode?i(t.__text):t.__text),n}function y(t){var n="";return t instanceof Object?n+=m(t):null!=t&&(n+=e.escapeMode?i(t):t),n}function g(e,t,n){var o="";if(0==e.length)o+=f(e,t,n,!0);else for(var r=0;r<e.length;r++)o+=f(e[r],t,v(e[r]),!1),o+=w(e[r]),o+=d(e[r],t);return o}function w(e){var t="",n=h(e);if(n>0)for(var o in e)if(!_(e,o)){var r=e[o],i=v(r);if(null==r||void 0==r)t+=f(r,o,i,!0);else if(r instanceof Object)if(r instanceof Array)t+=g(r,o,i);else if(r instanceof Date)t+=f(r,o,i,!1),t+=r.toISOString(),t+=d(r,o);else{var a=h(r);a>0||null!=r.__text||null!=r.__cdata?(t+=f(r,o,i,!1),t+=w(r),t+=d(r,o)):t+=f(r,o,i,!0)}else t+=f(r,o,i,!1),t+=y(r),t+=d(r,o)}return t+=y(e)}var b="1.1.5";e=e||{},t(),n();var x={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;var n;if(window.DOMParser){var o=new window.DOMParser,r=null;if(!t)try{r=o.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(i){r=null}try{n=o.parseFromString(e,"text/xml"),null!=r&&n.getElementsByTagNameNS(r,"parsererror").length>0&&(n=null)}catch(i){n=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(e);return n},this.asArray=function(e){return e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?c(e):e},this.xml2json=function(e){return l(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return w(e)},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return b}}!function(){var e={},t=null,n=!0,o=!1;try{"undefined"!=typeof AudioContext?t=new AudioContext:"undefined"!=typeof webkitAudioContext?t=new webkitAudioContext:n=!1}catch(r){n=!1}if(!n)if("undefined"!=typeof Audio)try{new Audio}catch(r){o=!0}else o=!0;if(n){var i="undefined"==typeof t.createGain?t.createGainNode():t.createGain();i.gain.value=1,i.connect(t.destination)}var a=function(e){this._volume=1,this._muted=!1,this.usingWebAudio=n,this.ctx=t,this.noAudio=o,this._howls=[],this._codecs=e,this.iOSAutoEnable=!0};a.prototype={volume:function(e){var t=this;if(e=parseFloat(e),e>=0&&1>=e){t._volume=e,n&&(i.gain.value=e);for(var o in t._howls)if(t._howls.hasOwnProperty(o)&&t._howls[o]._webAudio===!1)for(var r=0;r<t._howls[o]._audioNode.length;r++)t._howls[o]._audioNode[r].volume=t._howls[o]._volume*t._volume;return t}return n?i.gain.value:t._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(e){var t=this;t._muted=e,n&&(i.gain.value=e?0:t._volume);for(var o in t._howls)if(t._howls.hasOwnProperty(o)&&t._howls[o]._webAudio===!1)for(var r=0;r<t._howls[o]._audioNode.length;r++)t._howls[o]._audioNode[r].muted=e},codecs:function(e){return this._codecs[e]},_enableiOSAudio:function(){var e=this;if(!t||!e._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){e._iOSEnabled=!1;var n=function(){var o=t.createBuffer(1,1,22050),r=t.createBufferSource();r.buffer=o,r.connect(t.destination),"undefined"==typeof r.start?r.noteOn(0):r.start(0),setTimeout(function(){r.playbackState!==r.PLAYING_STATE&&r.playbackState!==r.FINISHED_STATE||(e._iOSEnabled=!0,e.iOSAutoEnable=!1,window.removeEventListener("touchend",n,!1))},0)};return window.addEventListener("touchend",n,!1),e}}};var u=null,c={};o||(u=new Audio,c={mp3:!!u.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!u.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!u.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!u.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!u.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(u.canPlayType("audio/x-m4a;")||u.canPlayType("audio/m4a;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(u.canPlayType("audio/x-mp4;")||u.canPlayType("audio/mp4;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!u.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var s=new a(c),l=function(e){var o=this;o._autoplay=e.autoplay||!1,o._buffer=e.buffer||!1,o._duration=e.duration||0,o._format=e.format||null,o._loop=e.loop||!1,o._loaded=!1,o._sprite=e.sprite||{},o._src=e.src||"",o._pos3d=e.pos3d||[0,0,-.5],o._volume=void 0!==e.volume?e.volume:1,o._urls=e.urls||[],o._rate=e.rate||1,o._model=e.model||null,o._onload=[e.onload||function(){}],o._onloaderror=[e.onloaderror||function(){}],o._onend=[e.onend||function(){}],o._onpause=[e.onpause||function(){}],o._onplay=[e.onplay||function(){}],o._onendTimer=[],o._webAudio=n&&!o._buffer,o._audioNode=[],o._webAudio&&o._setupAudioNode(),"undefined"!=typeof t&&t&&s.iOSAutoEnable&&s._enableiOSAudio(),s._howls.push(o),o.load()};if(l.prototype={load:function(){var e=this,t=null;if(o)return void e.on("loaderror",new Error("No audio support."));for(var n=0;n<e._urls.length;n++){var r,i;if(e._format)r=e._format;else{if(i=e._urls[n],r=/^data:audio\/([^;,]+);/i.exec(i),r||(r=/\.([^.]+)$/.exec(i.split("?",1)[0])),!r)return void e.on("loaderror",new Error("Could not extract format from passed URLs, please add format parameter."));r=r[1].toLowerCase()}if(c[r]){t=e._urls[n];break}}if(!t)return void e.on("loaderror",new Error("No codec support for selected audio sources."));if(e._src=t,e._webAudio)f(e,t);else{var u=new Audio;u.addEventListener("error",function(){u.error&&4===u.error.code&&(a.noAudio=!0),e.on("loaderror",{type:u.error?u.error.code:0})},!1),e._audioNode.push(u),u.src=t,u._pos=0,u.preload="auto",u.volume=s._muted?0:e._volume*s.volume();var l=function(){e._duration=Math.ceil(10*u.duration)/10,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play(),u.removeEventListener("canplaythrough",l,!1)};u.addEventListener("canplaythrough",l,!1),u.load()}return e},urls:function(e){var t=this;return e?(t.stop(),t._urls="string"==typeof e?[e]:e,t._loaded=!1,t.load(),t):t._urls},play:function(e,n){var o=this;return"function"==typeof e&&(n=e),e&&"function"!=typeof e||(e="_default"),o._loaded?o._sprite[e]?(o._inactiveNode(function(r){r._sprite=e;var i=r._pos>0?r._pos:o._sprite[e][0]/1e3,a=0;o._webAudio?(a=o._sprite[e][1]/1e3-r._pos,r._pos>0&&(i=o._sprite[e][0]/1e3+i)):a=o._sprite[e][1]/1e3-(i-o._sprite[e][0]/1e3);var u,c=!(!o._loop&&!o._sprite[e][2]),l="string"==typeof n?n:Math.round(Date.now()*Math.random())+"";if(function(){var t={id:l,sprite:e,loop:c};u=setTimeout(function(){!o._webAudio&&c&&o.stop(t.id).play(e,t.id),o._webAudio&&!c&&(o._nodeById(t.id).paused=!0,o._nodeById(t.id)._pos=0,o._clearEndTimer(t.id)),o._webAudio||c||o.stop(t.id),o.on("end",l)},a/o._rate*1e3),o._onendTimer.push({timer:u,id:t.id})}(),o._webAudio){var f=o._sprite[e][0]/1e3,d=o._sprite[e][1]/1e3;r.id=l,r.paused=!1,_(o,[c,f,d],l),o._playStart=t.currentTime,r.gain.value=o._volume,"undefined"==typeof r.bufferSource.start?c?r.bufferSource.noteGrainOn(0,i,86400):r.bufferSource.noteGrainOn(0,i,a):c?r.bufferSource.start(0,i,86400):r.bufferSource.start(0,i,a)}else{if(4!==r.readyState&&(r.readyState||!navigator.isCocoonJS))return o._clearEndTimer(l),function(){var t=o,i=e,a=n,u=r,c=function(){t.play(i,a),u.removeEventListener("canplaythrough",c,!1)};u.addEventListener("canplaythrough",c,!1)}(),o;r.readyState=4,r.id=l,r.currentTime=i,r.muted=s._muted||r.muted,r.volume=o._volume*s.volume(),setTimeout(function(){r.play()},0)}return o.on("play"),"function"==typeof n&&n(l),o}),o):("function"==typeof n&&n(),o):(o.on("load",function(){o.play(e,n)}),o)},pause:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.pause(e)}),t;t._clearEndTimer(e);var n=e?t._nodeById(e):t._activeNode();if(n)if(n._pos=t.pos(null,e),t._webAudio){if(!n.bufferSource||n.paused)return t;n.paused=!0,"undefined"==typeof n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else n.pause();return t.on("pause"),t},stop:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.stop(e)}),t;t._clearEndTimer(e);var n=e?t._nodeById(e):t._activeNode();if(n)if(n._pos=0,t._webAudio){if(!n.bufferSource||n.paused)return t;n.paused=!0,"undefined"==typeof n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else isNaN(n.duration)||(n.pause(),n.currentTime=0);return t},mute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.mute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=0:n.muted=!0),t},unmute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.unmute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=t._volume:n.muted=!1),t},volume:function(e,t){var n=this;if(e=parseFloat(e),e>=0&&1>=e){if(n._volume=e,!n._loaded)return n.on("play",function(){n.volume(e,t)}),n;var o=t?n._nodeById(t):n._activeNode();return o&&(n._webAudio?o.gain.value=e:o.volume=e*s.volume()),n}return n._volume},loop:function(e){var t=this;return"boolean"==typeof e?(t._loop=e,t):t._loop},sprite:function(e){var t=this;return"object"==typeof e?(t._sprite=e,t):t._sprite},pos:function(e,n){var o=this;if(!o._loaded)return o.on("load",function(){o.pos(e)}),"number"==typeof e?o:o._pos||0;e=parseFloat(e);var r=n?o._nodeById(n):o._activeNode();if(r)return e>=0?(o.pause(n),r._pos=e,o.play(r._sprite,n),o):o._webAudio?r._pos+(t.currentTime-o._playStart):r.currentTime;if(e>=0)return o;for(var i=0;i<o._audioNode.length;i++)if(o._audioNode[i].paused&&4===o._audioNode[i].readyState)return o._webAudio?o._audioNode[i]._pos:o._audioNode[i].currentTime},pos3d:function(e,t,n,o){var r=this;if(t="undefined"!=typeof t&&t?t:0,n="undefined"!=typeof n&&n?n:-.5,!r._loaded)return r.on("play",function(){r.pos3d(e,t,n,o)}),r;if(!(e>=0||0>e))return r._pos3d;if(r._webAudio){var i=o?r._nodeById(o):r._activeNode();i&&(r._pos3d=[e,t,n],i.panner.setPosition(e,t,n),i.panner.panningModel=r._model||"HRTF")}return r},fade:function(e,t,n,o,r){var i=this,a=Math.abs(e-t),u=e>t?"down":"up",c=a/.01,s=n/c;if(!i._loaded)return i.on("load",function(){i.fade(e,t,n,o,r)}),i;i.volume(e,r);for(var l=1;c>=l;l++)!function(){var e=i._volume+("up"===u?.01:-.01)*l,n=Math.round(1e3*e)/1e3,a=t;setTimeout(function(){i.volume(n,r),n===a&&o&&o()},s*l)}()},fadeIn:function(e,t,n){return this.volume(0).play().fade(0,e,t,n)},fadeOut:function(e,t,n,o){var r=this;return r.fade(r._volume,e,t,function(){n&&n(),r.pause(o),r.on("end")},o)},_nodeById:function(e){for(var t=this,n=t._audioNode[0],o=0;o<t._audioNode.length;o++)if(t._audioNode[o].id===e){n=t._audioNode[o];break}return n},_activeNode:function(){for(var e=this,t=null,n=0;n<e._audioNode.length;n++)if(!e._audioNode[n].paused){t=e._audioNode[n];break}return e._drainPool(),t},_inactiveNode:function(e){for(var t=this,n=null,o=0;o<t._audioNode.length;o++)if(t._audioNode[o].paused&&4===t._audioNode[o].readyState){e(t._audioNode[o]),n=!0;break}if(t._drainPool(),!n){var r;if(t._webAudio)r=t._setupAudioNode(),e(r);else{t.load(),r=t._audioNode[t._audioNode.length-1];var i=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",a=function(){r.removeEventListener(i,a,!1),e(r)};r.addEventListener(i,a,!1)}}},_drainPool:function(){var e,t=this,n=0;for(e=0;e<t._audioNode.length;e++)t._audioNode[e].paused&&n++;for(e=t._audioNode.length-1;e>=0&&!(5>=n);e--)t._audioNode[e].paused&&(t._webAudio&&t._audioNode[e].disconnect(0),n--,t._audioNode.splice(e,1))},_clearEndTimer:function(e){for(var t=this,n=-1,o=0;o<t._onendTimer.length;o++)if(t._onendTimer[o].id===e){n=o;break}var r=t._onendTimer[n];r&&(clearTimeout(r.timer),t._onendTimer.splice(n,1))},_setupAudioNode:function(){var e=this,n=e._audioNode,o=e._audioNode.length;return n[o]="undefined"==typeof t.createGain?t.createGainNode():t.createGain(),n[o].gain.value=e._volume,n[o].paused=!0,n[o]._pos=0,n[o].readyState=4,n[o].connect(i),n[o].panner=t.createPanner(),n[o].panner.panningModel=e._model||"equalpower",n[o].panner.setPosition(e._pos3d[0],e._pos3d[1],e._pos3d[2]),n[o].panner.connect(n[o]),n[o]},on:function(e,t){var n=this,o=n["_on"+e];if("function"==typeof t)o.push(t);else for(var r=0;r<o.length;r++)t?o[r].call(n,t):o[r].call(n);return n},off:function(e,t){var n=this,o=n["_on"+e];if(t){for(var r=0;r<o.length;r++)if(t===o[r]){o.splice(r,1);break}}else n["_on"+e]=[];return n},unload:function(){for(var t=this,n=t._audioNode,o=0;o<t._audioNode.length;o++)n[o].paused||(t.stop(n[o].id),t.on("end",n[o].id)),t._webAudio?n[o].disconnect(0):n[o].src="";for(o=0;o<t._onendTimer.length;o++)clearTimeout(t._onendTimer[o].timer);var r=s._howls.indexOf(t);null!==r&&r>=0&&s._howls.splice(r,1),delete e[t._src],t=null}},n)var f=function(t,n){if(n in e)return t._duration=e[n].duration,void p(t);if(/^data:[^;]+;base64,/.test(n)){for(var o=atob(n.split(",")[1]),r=new Uint8Array(o.length),i=0;i<o.length;++i)r[i]=o.charCodeAt(i);d(r.buffer,t,n)}else{var a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="arraybuffer",a.onload=function(){d(a.response,t,n)},a.onerror=function(){t._webAudio&&(t._buffer=!0,t._webAudio=!1,t._audioNode=[],delete t._gainNode,delete e[n],t.load())};try{a.send()}catch(u){a.onerror()}}},d=function(n,o,r){t.decodeAudioData(n,function(t){t&&(e[r]=t,p(o,t))},function(e){o.on("loaderror",e)})},p=function(e,t){e._duration=t?t.duration:e._duration,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play()},_=function(n,o,r){var i=n._nodeById(r);i.bufferSource=t.createBufferSource(),i.bufferSource.buffer=e[n._src],i.bufferSource.connect(i.panner),i.bufferSource.loop=o[0],o[0]&&(i.bufferSource.loopStart=o[1],i.bufferSource.loopEnd=o[1]+o[2]),i.bufferSource.playbackRate.value=n._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:s,Howl:l}}),"undefined"!=typeof exports&&(exports.Howler=s,exports.Howl=l),"undefined"!=typeof window&&(window.Howler=s,window.Howl=l)}();var jas={};!function(e){function t(e,t){function n(){l=l||0,e=e||0,f=!0,c=Date.now()}function o(){return e}function r(){s=!0}function i(n){e=t?Math.random()*n:n}function a(n,o){if(!s){var r=Date.now();return r-c>=e?(t&&i(l),"function"==typeof n?(c=r,n(r)):!0):"function"==typeof o?o(r-c):!1}}function u(){return Date.now()-c}var c,s,l=e||null,e=e||null,f=!!e,t=t||!1;return{start:n,stop:r,setTimer:i,checkTime:a,getInterval:o,getTime:u}}function n(){function e(e,t){o[e]=t}function t(e){return o[e]}function n(e,t){return o[e]==t}var o={};return{setState:e,getState:t,checkStatus:n}}function o(){function e(e,t){return"function"==typeof n[e]?n[e](t):!1}function t(e,t){"function"==typeof t&&(n[e]=t)}var n={constant:function(e){return function(t){return e}},linear:function(e,t){return function(n){return e*n+t}},exponential:function(e){return function(t){return t*t+e}},quadratic:function(e,t,n){return function(o){return e*o*o+t*o+n}},logarithmic:function(e){return function(e){}}};return{inst:e,newClass:t}}var r=o();e.Util={timer:t,finiteStateMachine:n,Graph:r}}(jas),function(e){function t(){function e(e){return{callback:e}}var t={};return{publish:function(e){for(var n in t)t[n].callback(e)},addSubscriber:function(n,o){t[n]=e(o)},removeSubscriber:function(e){t[e]=void 0,delete t[e]}}}var n={},o=0;e.Event={addPublication:function(e){n[e]=t()},remPublication:function(e){n[e]=void 0,delete n[e]},subscribe:function(e,t,r){var i;return arguments.length>2?(i=t,n[e].addSubscriber(i,r)):"function"==typeof t&&(i=t.name?t.name:"sub-"+o++,r=t,n[e].addSubscriber(i,r)),console.log(i),{unsubscribe:function(){console.log(i),n[e].removeSubscriber(i)},resubscribe:function(){n[e].addSubscriber(r.name,r)}}},unsubscribe:function(e,t){n[e].removeSubscriber(t)},publish:function(e,t){n[e].publish(t)}}}(jas),function(e){function t(e){l=e.imageRoot,f=e.audioRoot,d=e.mapRoot}function n(e,t,n){var o={},r=new XMLHttpRequest,i={};r.onreadystatechange=function(){var t=2==r.readyState;t&&(s.maps[e]=!1)},r.onload=function(){if(200==r.status){var t=new X2JS;i=t.xml_str2json(r.responseText).map,o.tileX=Number(i._height),o.tileY=Number(i._width),o.tileW=Number(i._tilewidth),o.tileH=Number(i._tileheight),o.x=0,o.y=0,o.w=o.tileX*o.tileW,o.h=o.tileX*o.tileH,o.layers={};for(var a in i.layer){var u={};u.name=i.layer[a]._name,u.width=i.layer[a]._width,u.height=i.layer[a]._height,u.entities=[];for(var c in i.layer[a].data.tile){var l={};l.tileId=Number(i.layer[a].data.tile[c]._gid),0!=l.tileId&&(l.tileId--,l.x=c*o.tileW%o.w,l.y=Math.floor(c*o.tileW/o.w)*o.tileH,u.entities.push(l))}u.properties={};for(var f in i.layer[a].properties){var d=i.layer[a].properties[f];u.properties[d._name]=d._value}o.layers[u.name]=u}}"function"==typeof n&&n(o),s.maps[e]=o},r.onerror=function(){console.error("error finding tmx file in newMap")},r.open("get",d+t,!0),r.send()}function o(e,t,n){var o=new Image;s.images[e]=!1,o.onload=function(){s.images[e]=o,"function"==typeof n&&n(o)},o.onerror=function(e){console.log(e)},o.src=t}function r(e,t,n){var o=new Image;s.images[e]=!1,o.onload=function(){s.images[e]=o,"function"==typeof n&&n(o)},o.onerror=function(e){console.log(e)},o.src=l+t}function i(e){return s.images[e]||!1}function a(e,t,n){s.audio[e]=!1,n="function"==typeof n?n:function(){};new Howl({urls:[f+t],onload:function(){console.log(this),n(this),s.audio[e]=this}})}function u(e,t){var n=s.audio[e];return console.log(n),"function"==typeof t&&n?(t(n),n):!1}function c(){for(var e in s){var t=s[e];for(var n in t){t[n];if(!n)return!1}}return!0}var s={images:{},audio:{},maps:{}},l="",f="",d="";e.Asset={configure:t,newImage:r,newImageFromCanvas:o,newAudio:a,getImage:i,getAudio:u,getMapData:n,assetsReady:c}}(jas),function(e){function t(e,t){_[t]=e}function n(e,t){var n=p[e]?p[e](t):{};return n}function o(e,t){p[e]=t}function r(e,t){var n=e.id;return t&&(f[t]=f[t]||{},f[t][n]=n),l[n]=e,e}function i(e){for(var t in f)delete f[t][e.id];delete l[e.id]}function a(e){for(var t in f)delete f[t][e];delete l[e]}function u(e,t){if(f[e]){var n=l[Object.keys(f[e]).sort()[0]];if(n&&"function"==typeof t)return t(n),n}}function c(e,t){var n=[];for(var o in f[e]){var r=f[e][o];n.push(l[r])}return"function"==typeof t&&n.forEach(t),n}function s(e,t){return c(e)[0]}var l={},f={},d=0,p={entity:function(t){var n={};t=t||{};var o,r=e.Util.finiteStateMachine();return n.setState=function(e,t){r.setState(e,t)},n.getState=function(e){return r.getState(e)},n.checkStatus=function(e,t,n,o){return r.checkStatus(e,t)?("function"==typeof n&&n(),!0):("function"==typeof o&&o(),!1)},n.setController=function(e){o=e||!1},n.id=d,d++,n.x=t.x||0,n.y=t.y||0,n.w=t.w||0,n.h=t.h||0,n},rect:function(e){var t=this.entity(e),n=e.color||null,o=null!=e.alpha?e.alpha:null;return t.getOrigin=function(){return{x:t.x,y:t.y}},t.getCenter=function(){var e=t.x+t.w/2,n=t.y+t.h/2;return{x:e,y:n}},t.getArea=function(){return t.w*t.h},t.getRandomVector=function(e,n,o,r){o=o||0,r=r||0;var i=Math.random()*(t.w+o)+t.x+e,a=Math.random()*(t.h+r)+t.y+n;return{x:i,y:a}},t.isColliding=function(e,n,o){if(t.getState("collideable")&&e.getState("collideable")){var r=this.x+this.w>e.x,i=this.y+this.h>e.y,a=e.x+e.w>this.x,u=e.y+e.h>this.y;return r&&i&&a&&u?("function"==typeof n?n():null,!0):("function"==typeof o?o():null,!1)}},t.contains=function(e,n,o){var r=e.x>t.x,i=e.x<t.x+t.w,a=e.y>t.y,u=e.y<t.y+t.h;return r&&i&&a&&u?("function"==typeof n?n():null,!0):("function"==typeof o?o():null,!1)},t.getDraw=function(){return{type:"rect",x:this.x,y:this.y,w:this.w,h:this.h,color:n,alpha:o}},t},circ:function(e){var t=this.entity(e),n=Math.pi*Math.pow(t.w/2,2);return t.getDraw=function(){return{type:"circ",x:this.x,y:this.y,w:this.w,h:this.h,color:color,alpha:alpha}},t.getArea=function(){return n},t.getCenter=function(){var e=t.x+t.w/2,n=t.y+t.h/2;return{x:e,y:n}},t},shape:function(e){var t=p[e.shape]?p[e.shape](e):p.rect(e);t.shape=e.shape;var n=e.collideable?e.collideable:!0;return t.setState("collideable",n),t},composite:function(e){var t=p.shape(e),n={};return t.getLayer=function(e,t){var o=n[e];if("function"!=typeof t||!o)return o;for(var r=0;r<o.length;r++)t(o[r])},t.addLayers=function(e){for(var n in e)t.addLayer(n,e[n])},t.addLayer=function(e,t){var o=t||[];n[e]=o},t.pushToLayer=function(e,t){var o=n[e];o.push(t)},t.orderLayers=function(){},t.getDraw=function(){return{type:"complex",layers:t.layers}},t},component:function(e){var t=p.composite(e);return t},widget:function(e){e.shape=e.shape||"rect";var t=p.component(e),n=e.padding||5,o=[];return t.addRow=function(e){function t(){var e=[];return e.w=0,e.h=0,e.addEntity=function(t){e.push(t.id)},e.getEntityDimensions=function(t){var n={},o=l[e[t]];return n.w=o.w,n.h=o.h,n},e}var n=t();o.push(n),"function"==typeof e&&e(n)},t.pack=function(){function e(){var e=0,r=0;for(var i in o){var a=o[i];a.w=0,a.h=0,a.col=0;for(var u in a){a.col++;var c=a[u];a.w+=c.w,a.h=c.h>a.h?c.h:a.h}a.h+=(i+1)*n,a.w+=(a.col+1)*n,e=a.w>e?a.w:e,r+=a.h}t.w=e,t.h=r}function r(){var e=t.y+n;for(var r in o){var i=o[r],a=t.x+n;for(var u in i){var c=0,s=i.col/t.w,l=i[u];entites[l].x=a,entites[l].y=e,a=s*c+n}e+=i.h+n}}e(),r()},t},text:function(t){function n(){var t=document.createElement("canvas");t.width=50,t.height=50;var n=t.getContext("2d"),c=n.measureText(a);t.width=c.width,t.height=50,n.font=i,n.fillStyle=o,n.globalAlpha=r,n.fillText(a,0,10);var s=t.toDataURL();e.Asset.newImageFromCanvas("text-image:"+u.id,s,function(e){document.appendChild(e);var n={type:"sprite",frame:{sx:0,sy:0,sw:t.width,sh:t.height,x:u.x,y:u.y,w:t.width,h:t.height},imageId:s};u.getDraw=function(){return n}})}t=t||{};var o=t.color||"#fff",r=t.color||1,i=t.font||"1em arial",a=t.string,u=p.sprite(t);return u.changeText=function(e){"function"==typeof e&&(a=e(a)),n()},u.getDraw=function(){return{type:"text",x:u.x,y:u.y,string:a,color:o,alpha:r,font:i}},n(),u},label:function(e){e=e||{};var t=p.component(e),n=(e.text||{},e.x),o=e.y,r=e.w,i=e.h,a=p.text({string:e.string,x:n,y:o+i,w:r,h:i,color:e.textColor,alpha:e.textAlpha}),u=e.shape||{},c=(u.type||"rect",p.rect({x:n,y:o,w:r,h:i,color:e.shapeColor,alpha:e.shapeAlpha}));return t.addLayers({text:[a],container:[c]}),t.changeLabelText=function(e){t.getLayer("text")[0].changeText(e)},t},sprite:function(t){function n(t){function n(e,t,n,o){return{sx:e,sy:t,sw:n,sh:o}}t=t?t:{};var r={};r.name=t.name;for(var a=t.start,u=t.stop,c=o.w,s=o.h,l=t.looping?t.looping:!1,f=(t.pingpong?t.pingpong:!1,t.fps?t.fps:12),d=[],p=a;u>p;p++){var _=p*c%i,h=Math.floor(p*c/i)*s;d.push(n(_,h,c,s))}var v=t.defaultFrame||d.length-1;r.onend=t.onend;var m=0,y=!1,g=e.Util.timer(1e3/f,!1);return g.start(),r.update=function(){y||g.checkTime(function(){var e=++m>=d.length;e&&l?m=0:e&&(m=v||d.length-1,"function"==typeof r.onend&&r.onend(),y=!0)})},r.getCurrentFrame=function(){return d[m]},r.reset=function(){m=0,y=!1},t.def&&(o.anim=r),r}var o=this.composite(t),r=t?t.imageId:null,i=e.Asset.getImage(r).width;e.Asset.getImage(r).height;o.animations={},t.animations=t.animations||[{name:"still",start:0,stop:1,def:!0}];for(var a in t.animations){var u=t.animations[a];o.animations[u.name]=n(u)}return o.setAnim=function(e){o.anim=o.animations[e]},o.getAnimId=function(){return o.anim.name},o.addAnim=function(e,t){o.animations[e]=n(t),t.def&&(o.anim=o.animations[e])},o.updateAnim=function(){o.anim.update()},o.resetAnim=function(e){e?o.animation[e].reset():o.anim.reset()},o.getDraw=function(){var e=o.anim.getCurrentFrame();return{type:"sprite",frame:e,x:this.x,y:this.y,w:this.w,h:this.h,imageId:r}},o},spawnZone:function(t){function n(){return"random"==s?function(){return o.getRandomVector(0,0,-a.w,-a.h)}:"center"==s?function(){return o.getCenter()}:function(){return o.getOrigin()}}var t=t||{};t.alpha=t.alpha||.4;var o=this.shape(t),r=t.intervalFixed!==!1,i=t.spawnType,a=t.spawnMutator||{},u=t.spawnRate||3e3,c=0,s=t.spawnPosition||"origin",l=t.spawnGroup||null,f=t.spawnMax||10,d={},p=e.Util.timer(u,r);p.start(),o.configureSpawn=function(e,t){i=e,a=t};var _=n(t.spawnPosition)||null;return o.setSpawnPosition=function(e){s=e,_=n()},o.spawn=function(){f>c&&p.checkTime(function(){var t=_();a.x=t.x,a.y=t.y;var n=e.Entity.inst(i,a);d[n.id]=n.id,e.Entity.addEntity(n,l),c++})},o.removeSpawn=function(t){delete d[t.id],e.Entity.removeEntityById(t.id),c--},o.removeSpawnById=function(t){delete d[t],e.Entity.removeEntityById(t),c--},o},tile:function(e){var e=e?e:{},t=this.sprite(e);return t.setAnim("tile"),t.tileId=e.tileId,t},map:function(e){e=e?e:{};var t=this.composite(e),n={},o=e.tileW,r=e.tileH,i=e.imageId;return t.configureTile=function(e,t){n[e]=t},t.makeTiles=function(){for(var a in e.layers){var u=[];for(var c in e.layers[a].entities){var s=e.layers[a].entities[c];n[s.tileId]?n[s.tileId]:function(e){return e};s.imageId=i,s.w=o,s.h=r,s.animations=[{name:"tile",start:s.tileId,stop:s.tileId+1,def:!0}];var l=p.tile(s);u.push(l)}t.addLayer(e.layers[a].name,u)}},t}},_={};e.Entity={inst:n,newClass:o,addEntity:r,removeEntity:i,removeEntityById:a,enumerateEntity:t,getFirst:u,getGroup:c,getMap:s}}(jas),function(e){function t(t){function n(t){var n=u[t.keyCode];i[t.keyCode]||e.Event.publish(n+"_IS_PRESSED"),i[t.keyCode]=!0}function o(t){delete i[t.keyCode];var n=u[t.keyCode];e.Event.publish(n+"_IS_UP")}function r(t){var n=i[a[t]];return n&&e.Event.publish(u[a[t]]+"_IS_DOWN"),!!n}s={},e.Event.addPublication("MOUSE_IS_PRESSED"),e.Event.addPublication("MOUSE_IS_DOWN"),e.Event.addPublication("MOUSE_IS_UP"),t.addEventListener("mousedown",function(t){s.mouseup&&(delete s.mouseup,e.Event.publish("MOUSE_IS_PRESSED",t)),s.mousedown=!0,e.Event.publish("MOUSE_IS_DOWN",t)},!1),t.addEventListener("mouseup",function(t){s.mousedown&&(delete s.mousedown,e.Event.publish("MOUSE_IS_UP",t)),s.mouseup=!0,window.setTimeout(function(){delete s.mouseup},10)},!1);var i={},a={UP:38,RIGHT:39,DOWN:40,LEFT:37,SPACE:32,ENTER:13,A:65,S:83,D:68,W:87,CTRL:17,SHIFT:16,ALT:18},u={};for(var c in a)u[a[c]]=c,e.Event.addPublication(c+"_IS_PRESSED"),e.Event.addPublication(c+"_IS_DOWN"),e.Event.addPublication(c+"_IS_UP");window.addEventListener("keydown",n,!1),window.addEventListener("keyup",o,!1);var s={isKeyDown:r,areKeysDown:function(e){for(var t in e){var n=e[t];r(n)}},areAllKeysDown:function(e,t){for(var n in e){var o=e[n];if(!r(o))return!1}return"function"==typeof t?t():null,!0},keysNotPressed:function(e){for(var t in e){var n=e[t];if(r(n))return!1}return"function"==typeof callback?callback():null,!0}};return s}function n(e,t){return i[e](t)}function o(e,t){return"function"!=typeof t?!1:void(i[e]=t)}var r=0,i={controller:function(t){function n(){for(var n in t){var o=e.Event.subscribe(n,t[n]);subscriptions["jas-controller-"+r]=o;
}}t=t||{};var o={};return subscriptions={},o.id=r++,n(),o.kill=function(){for(var e in subscriptions){var t=subscriptions[e];t.unsubscribe()}},o.revive=function(){for(var e in subscriptions){var t=subscriptions[e];t.resubscribe()}},o}};e.controllerFactory=t,e.Controller={inst:n,newClass:o}}(jas),function(e){function t(t,n){function o(e){var t=e.color||"#000";n.fillStyle=t,n.globalAlpha=null!=e.alpha?e.alpha:1;var o=e.x,r=e.y,i=e.w,a=e.h;n.fillRect(o,r,i,a),n.globalAlpha=1}function r(e){var t=e.color||"#000";n.fillStyle=t,n.globalAlpha=e.alpha||1;var o=e.x+e.w/2,r=e.y+e.h/2;n.beginPath(),n.arc(o,r,50,0,2*Math.PI),n.fill()}function i(e){var t=e.x,o=e.y,r=e.string;n.globalAlpha=e.alpha||1,n.fillStyle=e.color||"#fff",n.font=e.font||"1em arial",n.fillText(r,t,o),n.globalAlpha=1}function a(t){var o=e.Asset.getImage(t.imageId),r=t.frame,i=r.sx,a=r.sy,u=r.sw,c=r.sh,s=t.x,l=t.y,f=t.w,d=t.h;o&&n.drawImage(o,i,a,u,c,s,l,f,d)}function u(e){for(var t in e.layers){var n=e.layers[t];l(n)}}function c(t){var n=e.Entity.getGroup(t);l(n)}function s(t,n){e.Entity.getGroup(t,function(e){l(e.getLayer(n))})}function l(e){for(var t in e){var n=e[t],o=n.getDraw?n.getDraw():!1;o&&f(o)}}function f(e){switch(e.type){case"rect":o(e);break;case"circ":r(e);break;case"sprite":a(e);break;case"text":i(e);break;case"complex":u(e)}}function d(e,o){n.fillStyle=e?e:"#f0f",n.globalAlpha=o?o:1,n.fillRect(0,0,t.width,t.height)}function p(n,o){var r=t.toDataURL();e.Asset.newImage(n,r,o)}function _(){return{w:t.width,h:t.height}}return e.Graphics={getScreenImage:p,getScreenDimensions:_},{renderGroup:c,renderGroupLayer:s,fillScreen:d}}e.graphicsFactory=t}(jas),function(e){function t(e,t,n,o){a[e]={stateName:e,init:t,update:n,render:o},null==u&&(u=a[e])}function n(e,t,n){u.update(e,t),u.render(n)}function o(e){u=a[e]}function r(){0==Object.keys(a).length&&initError("You must inject at least one game state using jas.addState\n");for(var e in a)a[e].init()}function i(e){a[e].init()}var a={},u=null;e.State={addState:t,changeState:o,initAllStates:r,initState:i,updateState:n}}(jas),function(e){function t(t,n,o,l){var f=document.getElementById(t);r=document.createElement("canvas"),r.width=n||320,r.height=o||320,r.innerHTML="<h3>Your browser doesn't support HTML5 canvas!</h3>",r.innerHTML+="<p>Try one of these browsers...</p>",i=r.getContext("2d"),a=e.controllerFactory(r),u=e.graphicsFactory(r,i),f.appendChild(r),e.State.initAllStates(),c=1e3/l||1e3/60,s=e.Util.timer(c,!1)}function n(){s.start(),o()}function o(){f(o),s.checkTime(function(t){e.State.updateState(t,a,u)})}var r,i,a,u,c,s,l=window,f=l.requestAnimationFrame||l.mozRequestAnimationFrame||l.msRequestAnimationFrame||l.webkitRequestAnimationFrame||l.oRequestAnimationFrame;e.init=t,e.begin=n}(jas),function(e){function t(e,t){return"function"==typeof r[e]?r[e](t):!1}function n(e,t){"function"==typeof t&&(r[e]=t)}var o={UP:-1,RIGHT:1,DOWN:1,LEFT:-1},r={core:function(e){e=e||{};var t,n={};return n.bind=function(e){t=function(t,n){e[t]+=n},n.update=t},n},orthogonal:function(e){var t=0,n=0,i=r.core(e);return i.resetDirs=function(){t=0,n=0},i.resetDirX=function(){t=0},i.resetDirY=function(){n=0},i.up=function(e){n=o.UP,i.update("y",-e)},i.right=function(e){t=o.RIGHT,i.update("x",e)},i.down=function(e){n=o.DOWN,i.update("y",e)},i.left=function(e){t=o.LEFT,i.update("x",-e)},i.collide=function(e){n==o.UP?i.update("y",e):n==o.DOWN&&i.update("y",-e),t==o.RIGHT?i.update("x",-e):t==o.LEFT&&i.update("x",e)},i},radial:function(e){var t=r.core(e);t.move=function(e,t){}},platformer:function(e){e=e||{};var t=r.core();return t.left=function(){t.update("x",-val)},t.right=function(){t.update("x",val)},t.collide=function(){},t.jump=function(e,t){},t.gravity=function(e){t.update("y",e)},t}};e.Physics={inst:t,newClass:n}}(jas);